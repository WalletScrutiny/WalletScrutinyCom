---
wsId: bitkeyBlock
title: Bitkey - Bitcoin Wallet
altTitle: 
authors:
- danny
users: 1000
appId: world.bitkey.app
appCountry: US
released: 2024-02-28
updated: 2024-07-24
version: 2024.63.0 (4)
stars: 3.9
ratings: 
reviews: 10
size: 
website: https://bitkey.world
repository: https://github.com/proto-at-block/bitkey
issue: 
icon: world.bitkey.app.png
bugbounty: 
meta: ok
verdict: reproducible
date: 2024-07-26
signer: c0d0f9da7158cde788d0281e9ebd07034178165584d635f7ce17f77c037d961a
reviewArchive:
- date: 2024-03-23
  version: '2024.63.0 (2)'
  appHash: 110568d39beb8b0ccb6fc0f4ed710c2d129392137acc9e97202d5ac1ee192125
  gitRevision: 93c2de0de2ff3717c59dffa274b444490b4a45d6
  verdict: reproducible 
twitter: Bitkeyofficial
social:
- https://www.linkedin.com/company/bitkey-official
- https://www.facebook.com/profile.php?id=100088526238789
- https://www.instagram.com/ownbitkey
redirect_from: 
developerName: Block, Inc.
features:
- multiSignature

---

**Disclaimer**: The WalletScrutiny project is sponsored by Spiral, a subsidiary of Block.

<iframe width="560" height="315" src="https://www.youtube.com/embed/pZ-Yi7A-o_A?si=cP6zKgW7r-JosAb-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Analysis 

This is the **companion app** to the {% include walletLink.html wallet='hardware/blockhww' verdict='true' %}. It requires an NFC-capable phone, otherwise the app would not be installed.

The setup process involves:

- Opening the app and choosing "Set up new wallet". Without the hardware device, it would not be possible to set up a new wallet. The alternate option is "More Options".
    - More Options:
        - If the user selects More Options, the user can: 
           - Accept an Invite to be a trusted contact (An invite code generated by a bitkey holder is required)
           - Recover your wallet. If the user is on Android, this requires signing in to Google Drive. 
           - Import your wallet. Use the user's Emergency Access Kit to import the wallet. There is a mobile key code that is stored in the Emergency Access Kit which can be inputted in a field.
           - The Emergency Access Kit is a PDF document located in the device's cloud backup. It can be scanned with a QR code, or the details can be entered manually.
- Pair the hardware device with the app using NFC (no initial charging required).

- Once paired with a bitkey HWW this product can function as a wallet.

### Recovery Options

Here are the available recovery options [offered by Bitkey.](https://support.bitkey.world/hc/en-us/articles/18801968949652-What-recovery-methods-are-available  )

>  - [Cloud recovery](https://support.bitkey.world/hc/en-us/articles/18842210239764): Lost/Replaced phone with cloud backup available
>
>  - [Delay + Notify](https://support.bitkey.world/hc/en-us/articles/18842292452500):
>
>    - Lost/Replaced phone without cloud backup available
>
>    - Lost/Replaced hardware device with/without cloud backup available
>
>  - [Cloud Health Check](https://support.bitkey.world/hc/en-us/articles/24491938926484): Lost/Replaced Cloud account
>
>  - [Trusted Contacts:](https://support.bitkey.world/hc/en-us/articles/24395098961940) Lost/Replaced BOTH hardware device and phone, near the same time
>
>  - [Emergency Access Kit](https://support.bitkey.world/hc/en-us/articles/24395170222868): Bitkey app unavailable in app store(s)

<hr>

## Verified Builds

This is the [documentation](https://github.com/proto-at-block/bitkey/blob/main/app/verifiable-build/android/README.md) for the build process for the Bitkey Android app, and these are the [preparation instructions](https://github.com/proto-at-block/bitkey/blob/main/app/verifiable-build/android/README.md#prep-work).

## Update 2024-07-26 for version 2024.63.0 (4)

1. The existing bitkey script needs the build to be on a local machine connected via USB to a phone with Bitkey installed. It is cumbersome and crashes.
2. To address this concern, we will modify [`verify-android-apk`](https://github.com/proto-at-block/bitkey/pull/4/files#diff-40973f2588da23cffda3526ed003b4759acc3b1bbfc72b7a0e9ae64f5310486f) and [`convert-aab-to-apks`](https://github.com/proto-at-block/bitkey/pull/4/files#diff-f10be429543ced172e8edc9340113f28bc613622bd438fe59f3302ab9acf7db1). 
3. Proceeding with the build, we cloned the repository locally and executed `steps/download-apk-from-phone`
4. We uploaded the folder containing the split apks to our build server.
5. With the modified files, we proceeded with bitkey's instructions to [prep.](https://github.com/proto-at-block/bitkey/tree/main/app/verifiable-build/android)
6. We then execute: `./verify-android-apk -d /path/to/apk/directory -s /path/to/device-spec.json /path/to/bitkey/repo /path/to/build/directory`

## The Results of the Bitkey Verification Script

```
---------------------------

Comparing builds:

+ '[' 2 -ne 2 ']'
+ which diff
+ which /usr/local/android-sdk/build-tools/34.0.0/aapt2
+ lhs_comparable=/home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/comparable
+ lhs_apks=/home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names
+ rhs_comparable=/home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/comparable
+ rhs_apks=/home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names
++ find /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names -maxdepth 1 -mindepth 1 -type f -exec basename '{}' ';'
+ lhs_apk_files='base.apk
arm64_v8a.apk
en.apk
xxhdpi.apk'
++ find /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names -maxdepth 1 -mindepth 1 -type f -exec basename '{}' ';'
+ rhs_apk_files='base.apk
arm64_v8a.apk
en.apk
xxhdpi.apk'
+++ echo 'base.apk
arm64_v8a.apk
en.apk
xxhdpi.apk'
++ sort -u /dev/fd/63 /dev/fd/62
+++ echo 'base.apk
arm64_v8a.apk
en.apk
xxhdpi.apk'
+ all_apk_files='arm64_v8a.apk
base.apk
en.apk
xxhdpi.apk'
++ diff -x resources.arsc -r /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/comparable /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/co
mparable
+ differences=
+ diff_exit_status=0
+ diff_result=0
+ declare -a aapt_differences
+ for apk_file in $all_apk_files
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/arm64_v8a.apk ']'
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/arm64_v8a.apk ']'
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/arm64_v8a.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/arm64_v8a.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
---------                     -------
        0                     0 files
+ lhs_contains_resources_exit_code=11
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/arm64_v8a.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/arm64_v8a.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
---------                     -------
        0                     0 files
+ rhs_contains_resources_exit_code=11
+ '[' 11 -ne 0 ']'
+ '[' 11 -eq 0 ']'
+ '[' 11 -eq 0 ']'
+ echo 'Skipping aapt2 diff of arm64_v8a.apk as it doesn'\''t contain resources.arsc file'
Skipping aapt2 diff of arm64_v8a.apk as it doesn't contain resources.arsc file
+ for apk_file in $all_apk_files
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/base.apk ']'
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/base.apk ']'
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/base.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/base.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
   161032  1981-01-01 01:01   resources.arsc
---------                     -------
   161032                     1 file
+ lhs_contains_resources_exit_code=0
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/base.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/base.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
   161032  1981-01-01 01:01   resources.arsc
---------                     -------
   161032                     1 file
+ rhs_contains_resources_exit_code=0
+ '[' 0 -ne 0 ']'
+ '[' 0 -ne 0 ']'
++ /usr/local/android-sdk/build-tools/34.0.0/aapt2 diff /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/base.apk /home/danny/work/builds/world.bitkey.app/20
24-07-25/1/1-build-output/locally-built/normalized-names/base.apk
+ aapt_difference=
+ aapt_diff_exit_status=0
+ '[' '' '!=' '' ']'
+ diff_result=0
+ for apk_file in $all_apk_files
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/en.apk ']'
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/en.apk ']'
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/en.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/en.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
    64344  1981-01-01 01:01   resources.arsc
---------                     -------
    64344                     1 file
+ lhs_contains_resources_exit_code=0
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/en.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/en.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
    64344  1981-01-01 01:01   resources.arsc
---------                     -------
    64344                     1 file
+ rhs_contains_resources_exit_code=0
+ '[' 0 -ne 0 ']'
+ '[' 0 -ne 0 ']'
++ /usr/local/android-sdk/build-tools/34.0.0/aapt2 diff /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/en.apk /home/danny/work/builds/world.bitkey.app/2024
-07-25/1/1-build-output/locally-built/normalized-names/en.apk
+ aapt_difference=
+ aapt_diff_exit_status=0
+ '[' '' '!=' '' ']'
+ diff_result=0
+ for apk_file in $all_apk_files
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/xxhdpi.apk ']'
+ '[' '!' -f /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/xxhdpi.apk ']'
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/xxhdpi.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/xxhdpi.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
    11952  1981-01-01 01:01   resources.arsc
---------                     -------
    11952                     1 file
+ lhs_contains_resources_exit_code=0
+ unzip -l /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/xxhdpi.apk resources.arsc
Archive:  /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/locally-built/normalized-names/xxhdpi.apk
  Length      Date    Time    Name
---------  ---------- -----   ----
    11952  1981-01-01 01:01   resources.arsc
---------                     -------
    11952                     1 file
+ rhs_contains_resources_exit_code=0
+ '[' 0 -ne 0 ']'
+ '[' 0 -ne 0 ']'
++ /usr/local/android-sdk/build-tools/34.0.0/aapt2 diff /home/danny/work/builds/world.bitkey.app/2024-07-25/1/1-build-output/from-device/normalized-names/xxhdpi.apk /home/danny/work/builds/world.bitkey.app/
2024-07-25/1/1-build-output/locally-built/normalized-names/xxhdpi.apk
+ aapt_difference=
+ aapt_diff_exit_status=0
+ '[' '' '!=' '' ']'
+ diff_result=0
+ '[' 0 -eq 0 ']'
+ echo 'The builds are identical!'
The builds are identical!

```

A recording of the test:

{% include asciicast %}

## Diffs

`$ diff -r from-device/unpacked locally-built/unpacked`

```
Binary files from-device/unpacked/arm64_v8a/AndroidManifest.xml and locally-built/unpacked/arm64_v8a/AndroidManifest.xml differ
Only in from-device/unpacked/arm64_v8a: META-INF
Only in from-device/unpacked/arm64_v8a: stamp-cert-sha256
Binary files from-device/unpacked/base/AndroidManifest.xml and locally-built/unpacked/base/AndroidManifest.xml differ
Binary files from-device/unpacked/base/res/xml/splits0.xml and locally-built/unpacked/base/res/xml/splits0.xml differ
Binary files from-device/unpacked/base/resources.arsc and locally-built/unpacked/base/resources.arsc differ
Only in from-device/unpacked/base: stamp-cert-sha256
Binary files from-device/unpacked/en/AndroidManifest.xml and locally-built/unpacked/en/AndroidManifest.xml differ
Only in from-device/unpacked/en: META-INF
Binary files from-device/unpacked/en/resources.arsc and locally-built/unpacked/en/resources.arsc differ
Only in from-device/unpacked/en: stamp-cert-sha256
Binary files from-device/unpacked/xxhdpi/AndroidManifest.xml and locally-built/unpacked/xxhdpi/AndroidManifest.xml differ
Only in from-device/unpacked/xxhdpi: META-INF
Binary files from-device/unpacked/xxhdpi/resources.arsc and locally-built/unpacked/xxhdpi/resources.arsc differ
Only in from-device/unpacked/xxhdpi: stamp-cert-sha256
```

`$ diff -r from-device/normalized-names locally-built/normalized-names`

```
Binary files from-device/normalized-names/arm64_v8a.apk and locally-built/normalized-names/arm64_v8a.apk differ
Binary files from-device/normalized-names/base.apk and locally-built/normalized-names/base.apk differ
Binary files from-device/normalized-names/en.apk and locally-built/normalized-names/en.apk differ
Binary files from-device/normalized-names/xxhdpi.apk and locally-built/normalized-names/xxhdpi.apk differ
```

## We ran diffoscope on: 

- **unpacked/base/AndroidManifest.xml** and this is the [pastebin result](https://pastebin.com/EGp4cYZT)
- **unpacked/base/resources.arsc** the [pastebin result](https://pastebin.com/d7rPGtVv)
- **normalized-names/arm6_v8a.apk** - the [pastebin result](https://pastebin.com/vQD5jP7y)
  - `diffoscope from-device/normalized-names/arm64_v8a.apk locally-built/normalized-names/arm64_v8a.apk --text /home/danny/work/builds/world.bitkey.app/2024-07-25/1/diffoscope_arm64_v8a.txt`
- **normalized-names/base.apk** - the [pastebin result](https://pastebin.com/068TLXTd)
  - `diffoscope from-device/normalized-names/base.apk locally-built/normalized-names/base.apk --text /home/danny/work/builds/world.bitkey.app/2024-07-25/1/diffoscope_base.apk.txt`
- **normalized-names/en.apk** - the [pastebin result](https://pastebin.com/rzwnTbdW)
  - `diffoscope from-device/normalized-names/en.apk locally-built/normalized-names/en.apk --text /home/danny/work/builds/world.bitkey.app/2024-07-25/1/diffoscope_en.apk.txt`
- **normalized-names/xxhdpi.apk** - the [pastebin result](https://pastebin.com/CNKCZdC6)
  - `diffoscope from-device/normalized-names/xxhdpi.apk locally-built/normalized-names/xxhdpi.apk --text /home/danny/work/builds/world.bitkey.app/2024-07-25/1/diffoscope_xxhdpi.apk.txt`
- **unpacked/base/res/xml/splits0.xml** - the [pastebin result](https://pastebin.com/f025L2We)
  - `diffoscope from-device/unpacked/base/res/xml/splits0.xml locally-built/unpacked/base/res/xml/splits0.xml --text /home/danny/work/builds/world.bitkey.app/2024-07-25/1/diffoscope_splits0.xml.txt`

## LLM analysis of the diffoscope results:

1. **base.apk**
   ChatGPT4 Analysis:

   > - Significant differences in the APK Signing Block, particularly in keys and certificates. (APK Signing Block)
   > - Differences in permissions, attributes, or structure, indicating potential changes in the app configuration or build process. (AndroidManifest.xml)
   > - Variations in resource entries, IDs, or values, possibly due to different build tools or settings. (resources.arsc)

2. **arm64_v8a**
   ChatGPT4 Analysis:

   > - The APK Signing Block has substantial changes, including differences in keys and certificates.
   > - Key 0x42726577 and Key 0x6dff800d have different hexadecimal values, indicating different keys used for signing.
   > - Changes in byte values at specific offsets in AndroidManifest.xml
   > - Variations in resource files, which could be due to differences in resource processing, compression, or ordering during the build. (resources.arsc)

3. **xxhdpi**
   ChatGPT4 Analysis:

   > - The signing blocks differ significantly, with variations in keys and certificates, suggesting different signing processes or keys.
   > - Key 0x42726577 and Key 0x6dff800d show different hexadecimal values, indicating different keys used for signing.
  
4. **en.apk**
   ChatGPT4 Analysis:

   > - Differences in certificates and signing keys suggest different signatures or re-signing processes.
   > - Variations in META-INF/* files, such as MANIFEST.MF, CERT.SF, and CERT.RSA, indicate differences in the signing metadata.
   > - Differences in compiled resource files (resources.arsc).
   > - Variations in AndroidManifest.xml, possibly due to different build environments or configurations.
   > - Variations in file timestamps, ZIP metadata, and other metadata fields.

   **Claude.ai Analysis:**

   > Here are the key differences between the downloaded APK (from-device) and the locally built APK:\
   >
   > 1. APK Signing Block:\
   >    - The downloaded APK contains an APK Signing Block, while the locally built APK does not.\
   >    - This block includes several keys (0x42726577, 0x6dff800d, 0x7109871a, 0xf05368c0) with associated data.\
   >
   > 2. META-INF files:\
   >    - The downloaded APK contains META-INF/MANIFEST.MF, META-INF/BNDLTOOL.SF, and META-INF/BNDLTOOL.RSA files.\
   >    - The locally built APK is missing these META-INF files.\
   >
   > 3. AndroidManifest.xml:\
   >    - The downloaded APK's manifest includes additional attributes and a meta-data element:\
   >      - xmlns:n1="http://schemas.android.com/apk/distribution"\
   >      - n1:splitTypes=""\
   >      - `<meta-data>` element for "com.android.vending.derived.apk.id"\
   >    - The locally built APK's manifest is simpler and lacks these additional elements.\
   >
   > 4. File count and compression:\
   >    - The downloaded APK contains 6 files, while the locally built APK contains only 2 files.\
   >    - The downloaded APK has a slightly higher compression ratio (1.6% vs 0.6%).\
   >
   > 5. APK verification:\
   >    - The downloaded APK verifies successfully using v1, v2, and v3 signing schemes.\
   >    - The locally built APK fails verification due to missing META-INF/MANIFEST.MF.\
   >
   > 6. resources.arsc:\
   >    - Both APKs contain the resources.arsc file with the same size (64344 bytes).\
   >    - There might be minor differences in the file content, but they are not explicitly shown in the diff.\
   >
   > These differences primarily relate to the signing and metadata of the APKs. The core content (resources.arsc) appears to be the same size in both APKs, which is a good sign for reproducibility. However, the build process needs to be adjusted to include proper signing and metadata generation to match the downloaded APK more closely.

5. **splits0.xml**
   ChatGPT4 Analysis:

   > The diffoscope results show differences between two versions of the splits0.xml file. Key differences include changes in language configuration codes. For instance, entries such as config.in (Hindi), config.is (Icelandic), and config.it (Italian) are replaced with config.he (Hebrew), config.id (Indonesian), and so on. These changes reflect adjustments in the localization settings of the application, indicating updates in language support.


## Notes on the Bitkey Build 

Bitkey acknowledges the difference between apks extracted from AABs. More about this can be read [here](https://github.com/proto-at-block/bitkey/blob/main/app/verifiable-build/android/README.md#verification-notes):

  > Although Google Play should be using bundletool, APKs extracted from an AAB differ in more than just a signature.
  >
  > As mentioned above, we noticed a mismatch between language APKs downloaded by Google Play and those produced by bundletool. We use the --connected-device flag when invoking bundletool build-apks, which should produce the same set of APKs. However, looking at the output of bundletool get-device-spec, the supportedLocales list is often missing some languages that Google Play downloaded to the device.
  >
  > Another such difference are names of extracted APKs. We use the normalize-apk-names-new script to rename APK files to matching names.
  resources.arsc mismatch
  >
  > Until recently, once we normalized the APK names and contents, we could just run diff -r to check for identity. Unfortunately Google Play has changed how they build resources.arsc. From our testing, it seems like they are using a previously reserved byte. When built using bundletool, that byte is always 0, thus making direct comparison using diff impossible.
  >
  > Since resources are important part of the application, we're using aapt2 diff to check for differences between APKs from device and from bundletool.

From this we can conclude that the app is **reproducible**. 