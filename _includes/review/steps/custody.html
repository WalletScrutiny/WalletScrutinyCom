<div class="step custody">
  <i class="i-key circle"></i>
  <div class="title">
    <h3>Custody</h3>
    <p>
    {% assign conjunctionText = 'But' %}
    {% if include.platform == 'hardware' or include.platform == 'bearer' %}
      {% capture methodology %}<p>As part of <a href="/methodology/?tests-we-run/{{include.platform}}/prefilled">our Methodology</a>, we ask: <b>{{ site.data.verdicts['prefilled'].question }}</b></p>{% endcapture %}
      {% if page.verdict == 'prefilled' %}
        {{ site.data.verdicts[page.verdict].short }}
        {% capture answer %}<p>The answer is "no". Therefore we marked it as "<strong>{{ site.data.verdicts['prefilled'].title }}</strong>".<br><a href="#prefilled">Read more</a></p>{% endcapture %}
      {% else %}
        {{"Private keys generated and held by user"}}
        {% capture answer %}<p>The answer is "yes". <strong>Private keys are generated by the user on the wallet</strong>.<br><a href="#prefilled">Read more</a></p>{% endcapture %}
        {% endif %}
    {% else %}
      {% capture methodology %}<p>As part of <a href="/methodology/?tests-we-run/{{include.platform}}/custodial">our Methodology</a>, we ask: <b>{{ site.data.verdicts['custodial'].question }}</b></p>{% endcapture %}
        <!-- APPLY INDICES FOR VERDICTS -->
        {% assign custodyIndex = 0 %}
        {% assign verdictIndex = 0 %}
        {% assign iterationCount = 0 %}
        {% for verdict in site.data.platformMeta[include.platform].verdicts %}
          {% assign iterationCount = iterationCount | plus: 1 %}
          {% case verdict %}
            {% when page.verdict %}
              {% assign verdictIndex = iterationCount %}
            {% when 'custodial' %}
              {% assign custodyIndex = iterationCount %}
            {% else %}
          {% endcase %}
        {% endfor %}

        <!-- DID NOT TEST FOR CUSTODY -->
        {% if custodyIndex > verdictIndex %}
        {{ site.data.verdicts[page.verdict].short }}
        {% capture answer %}<p>However, we did not run this test because we failed at a <a href="#{{page.verdict}}">preceding test</a>.<br><a href="#custodial">Read more</a></p>{% endcapture %}
        {% assign conjunctionText = 'Also' %}
        <!-- IS NOT SELF-CUSTODIAL -->
        {% elsif page.verdict == 'custodial' %}
        {{ site.data.verdicts[page.verdict].short }}
        {% capture answer %}<p>The answer is "no". Therefore we marked it as "<strong>{{ site.data.verdicts['custodial'].title }}</strong>".<br><a href="#custodial">Read more</a></p>{% endcapture %}
        <!-- IS SELF-CUSTODIAL -->
        {% else %}
        {{"Self-custodial: The user holds the keys"}}
        {% capture answer %} <p>The answer is "yes". <strong>The user has control of their own keys</strong>.<br><a href="#custodial">Read more</a></p>{% endcapture %}
        {% endif %}
    {% endif %}
    {% if page.meta != "ok" %}
      <p class="warn">{{ conjunctionText }} 
        <span class="lower">{{ site.data.verdicts[page.meta].message }}</span>
      </p>
    {% endif %}
    </p>
    <div class="textbox">
      {{methodology}}
      {{answer}}
    </div>
  </div>
  <div class="data">
  </div>
  {% if page.tooltip.custody %}
    {% assign exists = 'exists' %}
  {% endif %}
  <div class="tooltip-element {{exists}}">
    <i class="info-circle">
      <span class="i-info-circle-green"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    </i>
  {% if page.tooltip.custody %}
    <div class="tooltip-payload">
      <h3></h3>
      {{ page.tooltip.custody | markdownify }}
    </div>
  {% endif %}
  </div>
</div>